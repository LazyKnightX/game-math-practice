<!-- https://zh.wikipedia.org/wiki/%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0 -->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sinå‡½æ•°åº”ç”¨ - æ–¹å‘ç§»åŠ¨ä¸åœ†å‘¨è¿åŠ¨</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #1a1a1a;
            font-family: Arial, sans-serif;
            color: #fff;
        }

        canvas {
            border: 2px solid #00ff00;
            background-color: #0a0a0a;
            margin: 20px 0;
        }

        .controls {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            width: 800px;
        }

        .control-group {
            margin: 10px 0;
        }

        label {
            display: inline-block;
            width: 150px;
            color: #00ff00;
        }

        input[type="range"] {
            width: 200px;
        }

        button {
            background-color: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            border-radius: 4px;
            font-weight: bold;
        }

        button:hover {
            background-color: #00cc00;
        }

        .info {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            width: 800px;
            font-family: monospace;
        }

        .info-line {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ® Sinå‡½æ•°æ¸¸æˆåº”ç”¨æ¼”ç¤º</h1>

    <div class="controls">
        <h3>æ§åˆ¶é¢æ¿</h3>

        <div class="control-group">
            <label>ç©å®¶é€Ÿåº¦:</label>
            <input type="range" id="playerSpeed" min="1" max="10" value="5" step="0.5">
            <span id="playerSpeedValue">5</span>
        </div>

        <div class="control-group">
            <label>æ•Œäººæ•°é‡:</label>
            <input type="range" id="enemyCount" min="1" max="10" value="3" step="1">
            <span id="enemyCountValue">3</span>
        </div>

        <div class="control-group">
            <label>åœ†å‘¨åŠå¾„:</label>
            <input type="range" id="orbitRadius" min="50" max="200" value="100" step="10">
            <span id="orbitRadiusValue">100</span>
        </div>

        <div class="control-group">
            <label>æ—‹è½¬é€Ÿåº¦:</label>
            <input type="range" id="rotationSpeed" min="0.5" max="5" value="2" step="0.5">
            <span id="rotationSpeedValue">2</span>
        </div>

        <div class="control-group">
            <button id="resetBtn">é‡ç½®</button>
            <button id="pauseBtn">æš‚åœ</button>
        </div>
    </div>

    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <div class="info">
        <h3>ğŸ“Š å®æ—¶ä¿¡æ¯</h3>
        <div class="info-line">ç©å®¶ä½ç½®: X=<span id="playerX">400</span>, Y=<span id="playerY">300</span></div>
        <div class="info-line">ç©å®¶è§’åº¦: <span id="playerAngle">0</span>Â°</div>
        <div class="info-line">é¼ æ ‡è§’åº¦: <span id="mouseAngle">0</span>Â°</div>
        <div class="info-line">FPS: <span id="fps">60</span></div>
        <div class="info-line">
            <br>
            <strong>æ“ä½œè¯´æ˜:</strong><br>
            â€¢ WASD æˆ– æ–¹å‘é”® - ç§»åŠ¨ç©å®¶<br>
            â€¢ é¼ æ ‡ç§»åŠ¨ - ç©å®¶æœå‘é¼ æ ‡æ–¹å‘<br>
            â€¢ æ•Œäººä¼šå›´ç»•ç©å®¶åšåœ†å‘¨è¿åŠ¨
        </div>
    </div>

    <script>
        // ========== ç”»å¸ƒåˆå§‹åŒ– ==========
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // ========== æ¸¸æˆçŠ¶æ€ ==========
        let isPaused = false;
        let lastTime = 0;
        let fps = 0;

        // ========== ç©å®¶å¯¹è±¡ ==========
        const player = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: 15,
            angle: 0,  // æœå‘è§’åº¦ï¼ˆå¼§åº¦ï¼‰
            speed: 5,
            color: '#00ff00',

            // TODO: å®Œå–„ç§»åŠ¨æ–¹æ³•
            move: function(directionAngle, speed) {
                // æç¤ºï¼šä½¿ç”¨ Math.cos() å’Œ Math.sin() è®¡ç®—xå’Œyæ–¹å‘çš„é€Ÿåº¦åˆ†é‡
                // velocityX = speed * Math.cos(angle)
                // velocityY = speed * Math.sin(angle)

                // ä½ çš„ä»£ç ï¼š

                // è¾¹ç•Œæ£€æµ‹
                this.x = Math.max(this.radius, Math.min(canvas.width - this.radius, this.x));
                this.y = Math.max(this.radius, Math.min(canvas.height - this.radius, this.y));
            },

            draw: function() {
                // ç»˜åˆ¶ç©å®¶åœ†å½¢
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();

                // TODO: ç»˜åˆ¶æ–¹å‘æŒ‡ç¤ºçº¿
                // æç¤ºï¼šä»ç©å®¶ä¸­å¿ƒç”»ä¸€æ¡æŒ‡å‘angleæ–¹å‘çš„çº¿
                // ç»ˆç‚¹åæ ‡ = (x + cos(angle) * length, y + sin(angle) * length)

                // ä½ çš„ä»£ç ï¼š

            }
        };

        // ========== æ•Œäººæ•°ç»„ ==========
        let enemies = [];

        // ========== æ•Œäººç±» ==========
        class Enemy {
            constructor(index, total) {
                // TODO: åˆå§‹åŒ–æ•Œäººçš„èµ·å§‹è§’åº¦
                // æç¤ºï¼šå°†360åº¦å¹³å‡åˆ†é…ç»™æ‰€æœ‰æ•Œäºº
                // angle = (index / total) * 2 * Math.PI

                this.angle = 0; // ä½ çš„ä»£ç 
                this.orbitRadius = 100;
                this.rotationSpeed = 2;
                this.radius = 10;
                this.color = '#ff0000';
                this.index = index;
            }

            // TODO: å®Œå–„æ›´æ–°æ–¹æ³•
            update(deltaTime, centerX, centerY) {
                // æç¤ºï¼š
                // 1. æ›´æ–°è§’åº¦ï¼šangle += rotationSpeed * deltaTime
                // 2. è®¡ç®—ä½ç½®ï¼šx = centerX + cos(angle) * radius
                //              y = centerY + sin(angle) * radius

                // ä½ çš„ä»£ç ï¼š


            }

            draw() {
                // ç»˜åˆ¶æ•Œäºº
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();

                // TODO: ç»˜åˆ¶è½¨é“åœ†åœˆï¼ˆè™šçº¿ï¼‰
                // æç¤ºï¼šä½¿ç”¨ ctx.setLineDash([5, 5]) ç»˜åˆ¶è™šçº¿åœ†

                // ä½ çš„ä»£ç ï¼š

            }
        }

        // ========== è¾“å…¥æ§åˆ¶ ==========
        const keys = {};
        const mouse = {
            x: canvas.width / 2,
            y: canvas.height / 2
        };

        // é”®ç›˜äº‹ä»¶
        window.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
        });

        window.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        // é¼ æ ‡äº‹ä»¶
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouse.x = e.clientX - rect.left;
            mouse.y = e.clientY - rect.top;
        });

        // ========== è¾“å…¥å¤„ç† ==========
        function handleInput() {
            let moveX = 0;
            let moveY = 0;

            // WASD å’Œ æ–¹å‘é”®æ§åˆ¶
            if (keys['w'] || keys['arrowup']) moveY -= 1;
            if (keys['s'] || keys['arrowdown']) moveY += 1;
            if (keys['a'] || keys['arrowleft']) moveX -= 1;
            if (keys['d'] || keys['arrowright']) moveX += 1;

            // TODO: å¦‚æœæœ‰ç§»åŠ¨è¾“å…¥ï¼Œè®¡ç®—ç§»åŠ¨è§’åº¦å¹¶ç§»åŠ¨ç©å®¶
            // æç¤ºï¼š
            // 1. ä½¿ç”¨ Math.atan2(moveY, moveX) è®¡ç®—ç§»åŠ¨è§’åº¦
            // 2. è°ƒç”¨ player.move(angle, speed)

            if (moveX !== 0 || moveY !== 0) {
                // ä½ çš„ä»£ç ï¼š

                let moveDeg = Math.atan2(moveY, moveX);
                let moveSpd = 2;
                player.move(moveDeg, moveSpd);
            }

            // TODO: è®¡ç®—ç©å®¶æœå‘é¼ æ ‡çš„è§’åº¦
            // æç¤ºï¼šä½¿ç”¨ Math.atan2(mouse.y - player.y, mouse.x - player.x)

            // ä½ çš„ä»£ç ï¼š

        }

        // ========== åˆå§‹åŒ–æ•Œäºº ==========
        function initEnemies(count) {
            enemies = [];
            for (let i = 0; i < count; i++) {
                enemies.push(new Enemy(i, count));
            }
        }

        // ========== æ›´æ–°æ¸¸æˆ ==========
        function update(deltaTime) {
            if (isPaused) return;

            // å¤„ç†è¾“å…¥
            handleInput();

            // TODO: æ›´æ–°æ‰€æœ‰æ•Œäºº
            // æç¤ºï¼šéå†enemiesæ•°ç»„ï¼Œè°ƒç”¨æ¯ä¸ªæ•Œäººçš„updateæ–¹æ³•

            // ä½ çš„ä»£ç ï¼š

        }

        // ========== ç»˜åˆ¶æ¸¸æˆ ==========
        function draw() {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#0a0a0a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶ç½‘æ ¼ï¼ˆå¯é€‰ï¼‰
            drawGrid();

            // ç»˜åˆ¶ä¸­å¿ƒåå­—ï¼ˆå‚è€ƒç‚¹ï¼‰
            drawCenterCross();

            // TODO: ç»˜åˆ¶æ‰€æœ‰æ•Œäºº
            // ä½ çš„ä»£ç ï¼š


            // ç»˜åˆ¶ç©å®¶
            player.draw();

            // ç»˜åˆ¶é¼ æ ‡ä½ç½®ï¼ˆè°ƒè¯•ç”¨ï¼‰
            drawMouseIndicator();
        }

        // ========== è¾…åŠ©ç»˜åˆ¶å‡½æ•° ==========
        function drawGrid() {
            ctx.strokeStyle = '#1a1a1a';
            ctx.lineWidth = 1;

            // å‚ç›´çº¿
            for (let x = 0; x < canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }

            // æ°´å¹³çº¿
            for (let y = 0; y < canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }

        function drawCenterCross() {
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;

            // å‚ç›´çº¿
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.stroke();

            // æ°´å¹³çº¿
            ctx.beginPath();
            ctx.moveTo(0, canvas.height / 2);
            ctx.lineTo(canvas.width, canvas.height / 2);
            ctx.stroke();
        }

        function drawMouseIndicator() {
            ctx.strokeStyle = '#ffff00';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(mouse.x, mouse.y, 5, 0, Math.PI * 2);
            ctx.stroke();
        }

        // ========== æ›´æ–°UIä¿¡æ¯ ==========
        function updateInfo() {
            document.getElementById('playerX').textContent = Math.round(player.x);
            document.getElementById('playerY').textContent = Math.round(player.y);
            document.getElementById('playerAngle').textContent = Math.round(player.angle * 180 / Math.PI);

            // TODO: è®¡ç®—å¹¶æ˜¾ç¤ºé¼ æ ‡ç›¸å¯¹äºç©å®¶çš„è§’åº¦
            // ä½ çš„ä»£ç ï¼š
            const mouseAngle = 0; // è®¡ç®—é¼ æ ‡è§’åº¦
            document.getElementById('mouseAngle').textContent = Math.round(mouseAngle * 180 / Math.PI);

            document.getElementById('fps').textContent = Math.round(fps);
        }

        // ========== æ¸¸æˆä¸»å¾ªç¯ ==========
        function gameLoop(currentTime) {
            // è®¡ç®—deltaTimeï¼ˆç§’ï¼‰
            const deltaTime = (currentTime - lastTime) / 1000;
            lastTime = currentTime;

            // è®¡ç®—FPS
            if (deltaTime > 0) {
                fps = 1 / deltaTime;
            }

            // æ›´æ–°å’Œç»˜åˆ¶
            update(deltaTime);
            draw();
            updateInfo();

            // ç»§ç»­å¾ªç¯
            requestAnimationFrame(gameLoop);
        }

        // ========== æ§åˆ¶é¢æ¿äº‹ä»¶ ==========
        document.getElementById('playerSpeed').addEventListener('input', (e) => {
            player.speed = parseFloat(e.target.value);
            document.getElementById('playerSpeedValue').textContent = e.target.value;
        });

        document.getElementById('enemyCount').addEventListener('input', (e) => {
            const count = parseInt(e.target.value);
            initEnemies(count);
            document.getElementById('enemyCountValue').textContent = count;
        });

        document.getElementById('orbitRadius').addEventListener('input', (e) => {
            const radius = parseInt(e.target.value);
            enemies.forEach(enemy => enemy.orbitRadius = radius);
            document.getElementById('orbitRadiusValue').textContent = radius;
        });

        document.getElementById('rotationSpeed').addEventListener('input', (e) => {
            const speed = parseFloat(e.target.value);
            enemies.forEach(enemy => enemy.rotationSpeed = speed);
            document.getElementById('rotationSpeedValue').textContent = speed;
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            player.x = canvas.width / 2;
            player.y = canvas.height / 2;
            player.angle = 0;
            initEnemies(enemies.length);
        });

        document.getElementById('pauseBtn').addEventListener('click', (e) => {
            isPaused = !isPaused;
            e.target.textContent = isPaused ? 'ç»§ç»­' : 'æš‚åœ';
        });

        // ========== å¯åŠ¨æ¸¸æˆ ==========
        initEnemies(3);
        requestAnimationFrame(gameLoop);

        console.log('ğŸ® æ¸¸æˆå·²å¯åŠ¨ï¼');
        console.log('ğŸ“ TODOåˆ—è¡¨ï¼š');
        console.log('1. å®Œå–„ player.move() æ–¹æ³•');
        console.log('2. å®Œå–„ player.draw() ä¸­çš„æ–¹å‘æŒ‡ç¤ºçº¿');
        console.log('3. å®Œå–„ Enemy æ„é€ å‡½æ•°ä¸­çš„è§’åº¦åˆå§‹åŒ–');
        console.log('4. å®Œå–„ Enemy.update() æ–¹æ³•');
        console.log('5. å®Œå–„ Enemy.draw() ä¸­çš„è½¨é“åœ†åœˆ');
        console.log('6. å®Œå–„ handleInput() ä¸­çš„ç§»åŠ¨é€»è¾‘');
        console.log('7. å®Œå–„ handleInput() ä¸­çš„æœå‘é€»è¾‘');
        console.log('8. å®Œå–„ update() ä¸­çš„æ•Œäººæ›´æ–°');
        console.log('9. å®Œå–„ draw() ä¸­çš„æ•Œäººç»˜åˆ¶');
        console.log('10. å®Œå–„ updateInfo() ä¸­çš„é¼ æ ‡è§’åº¦è®¡ç®—');
    </script>
</body>
</html>
